<div class="h-auto md:min-h-screen p-6 bg-gray-100" dir="rtl">
  <!-- ุนุฑุถ ุงูููุงู ูุฃุฌูุฒุฉ ุณุทุญ ุงูููุชุจ -->
  <div class="hidden md:block overflow-x-auto mt-10 mx-auto rounded-md border border-gray-300">
    <table class="w-full text-right rounded-lg">
      <thead class="bg-gray-100">
        <tr>
          <th class="p-3 border-b">ุงุณู ุงููููุฉ</th>
          <th class="p-3 border-b">ุชุงุฑูุฎ ุงูุชุณููู</th>
          <th class="p-3 border-b">ุญุงูุฉ ุงูุชุณููู</th>
          <th class="p-3 border-b">ุงููุฑูู</th>
          <th class="p-3 border-b">ุงูุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let assignment of ass" class="border-b">
          <td class="p-3">{{ assignment.title }}</td>
          <td class="p-3">{{ assignment.due_date }}</td>
          <td class="p-3">
            <span [ngClass]="{
              'text-green-600': assignment.submission_status === 'Submitted',
              'text-red-600': assignment.submission_status === 'Not Submitted',
              'text-gray-500': !assignment.submission_status
            }">
              {{ assignment.submission_status || 'ุฌุงุฑู ุงูุชุญููู...' }}
            </span>
          </td>
          <td class="p-3">
  <a *ngIf="assignment.attachment" 
     [href]="assignment.attachment" 
     download 
     class="text-blue-600 hover:underline"
     target="_blank">
    ุชุญููู
  </a>
  <p *ngIf="!assignment.attachment" 
     >
    ุจูุง ูุฑูู
</p>
<!-- ุฒุฑ ุนุฑุถ ุงููุตู -->
<button class="ml-2 text-blue-600 underline" (click)="showDescription(assignment.description)">
  ุนุฑุถ ุงููุตู
</button>

</td>
          <td class="p-3">
            <button class="px-4 py-1 rounded text-black border"
              [disabled]="isPastDue(assignment.due_date)"
              (click)="openSubmissionModal(assignment)">
              {{ assignment.submission_status === 'Submitted' ? 'ุฅุนุงุฏุฉ ุงูุฅุฑุณุงู' : 'ุฅุฑุณุงู' }}
            </button>
            <button class="px-4 py-1 rounded text-blue-600 border ml-2"
                    *ngIf="assignment.submission_status === 'Submitted'"
                    (click)="showReview(assignment.submission_id)">
              ุนุฑุถ ุงููุฑุงุฌุนุฉ
            </button>

          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ุนุฑุถ ุงูููุงู ููุฌูุงู -->
<div class="md:hidden overflow-x-auto mt-10 mx-auto rounded-md border border-gray-300" dir="rtl">
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
    <div class="bg-white p-6 rounded-lg shadow-md" *ngFor="let assignment of ass">
      <h3 class="text-lg font-semibold text-right">{{ assignment.title }}</h3>
      <p class="text-sm text-gray-500 text-right">ุชุงุฑูุฎ ุงูุชุณููู: {{ assignment.due_date }}</p>
      <p class="text-sm text-gray-500 text-right">ุงููุตู: {{ assignment.description }}</p>
      <p class="mt-2 text-right">
        <span [ngClass]="{
          'text-green-600': assignment.submission_status === 'Submitted',
          'text-red-600': assignment.submission_status === 'Not Submitted',
          'text-gray-500': !assignment.submission_status
        }">
          {{ assignment.submission_status || 'ุฌุงุฑู ุงูุชุญููู...' }}
        </span>
      </p>
      <div class="text-sm text-right">
  <span *ngIf="assignment.attachment">
    ๐ 
    <a [href]="assignment.attachment" 
       download 
       class="text-blue-600 hover:underline" 
       target="_blank">ุชุญููู ุงููุฑูู</a>
  </span>
  <div *ngIf="!assignment.attachment" 
     >
    ุจูุง ูุฑูู
</div>
<!-- ุฒุฑ ุนุฑุถ ุงููุตู -->
<button class="ml-2 text-blue-600 underline" (click)="showDescription(assignment.description)">
  ุนุฑุถ ุงููุตู
</button>

</div>

      <div class="mt-4 text-right">
        <button class="px-4 py-1 rounded text-black border"
          [disabled]="isPastDue(assignment.due_date)"
          (click)="openSubmissionModal(assignment)">
          {{ assignment.submission_status === 'Submitted' ? 'ุฅุนุงุฏุฉ ุงูุฅุฑุณุงู' : 'ุฅุฑุณุงู' }}
        </button>
        <button class="px-4 py-1 rounded text-blue-600 border ml-2"
        *ngIf="assignment.submission_status === 'Submitted'"
        (click)="showReview(assignment.submission_id)">
  ุนุฑุถ ุงููุฑุงุฌุนุฉ
</button>

      </div>
    </div>
  </div>
</div>

<!-- ูุงูุฐุฉ ุฅุฑุณุงู ุงููููุฉ -->
<div *ngIf="showModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50" dir="rtl">
  <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
    <h2 class="text-lg font-semibold mb-4 text-right">ุฅุฑุณุงู ุงููููุฉ</h2>

    <div *ngIf="submitting" class="w-full bg-gray-200 rounded h-2 mt-4">
      <div class="bg-blue-600 h-full rounded transition-all" [style.width.%]="uploadProgress"></div>
    </div>

    <textarea [(ngModel)]="submissionText" rows="4" placeholder="ุงูุชุจ ุฅุฌุงุจุชู ููุง..." class="w-full p-2 border rounded mb-4 text-right"></textarea>

    <input type="file" (change)="onFileSelected($event)" class="mb-4 w-full" />

    <div class="flex justify-between">
      <button (click)="closeModal()" class="text-gray-600">ุฅูุบุงุก</button>
      <button (click)="submitAssignment()" class="bg-blue-600 text-white px-4 py-2 rounded">ุฅุฑุณุงู</button>
    </div>
  </div>
</div>
<div *ngIf="showReviewModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md" dir="rtl">
    <h2 class="text-lg font-semibold mb-4 text-right">ูุฑุงุฌุนุฉ ุงููุนูู</h2>

    <div *ngIf="selectedReview">
      <p><strong>ุงูุฏุฑุฌุฉ:</strong> {{ selectedReview.score }}</p>
      <p><strong>ุชุนููู ุงููุนูู:</strong></p>
      <p class="whitespace-pre-line">{{ selectedReview.feedback }}</p>
    </div>

    <div *ngIf="!selectedReview">
      <p class="text-gray-600">{{ reviewMessage || 'ุฌุงุฑู ุงูุชุญููู...' }}</p>
    </div>

    <div class="mt-4 text-left">
      <button (click)="showReviewModal = false" class="text-blue-600 hover:underline">ุฅุบูุงู</button>
    </div>
  </div>
</div>
<!-- ูุงูุฐุฉ ุนุฑุถ ุงููุตู -->
<div *ngIf="showDescriptionModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50" dir="rtl">
  <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-lg text-right">
    <h2 class="text-lg font-semibold mb-4">ูุตู ุงููููุฉ</h2>
    <p class="text-gray-800 whitespace-pre-wrap">{{ currentDescription }}</p>

    <div class="mt-6 text-left">
      <button (click)="closeDescription()" class="bg-gray-300 px-4 py-2 rounded">ุฅุบูุงู</button>
    </div>
  </div>
</div>
