<div class="p-6 bg-gray-100 min-h-screen" dir="rtl">
  <h2 class="text-xl font-semibold mb-4">غرفة دردشة النادي</h2>

  <!-- الرسائل -->
  <div class="bg-white p-4 rounded shadow mb-4 overflow-y-auto max-h-[60vh] flex flex-col-reverse">

  <!-- الرسائل -->
  <div *ngFor="let msg of messages.slice().reverse()" class="mb-3 flex"
       [ngClass]="{ 'justify-end': msg.sender.id === studentId, 'justify-start': msg.sender.id !== studentId }">

    <!-- رسالتي -->
    <div *ngIf="msg.sender.id === studentId"
         class="p-2 rounded-lg bg-blue-500 text-white max-w-[70%] text-right shadow">
      <p class="text-sm break-words">{{ msg.message }}</p>
      <p class="text-xs text-white text-left mt-1">أنا</p>
    </div>

    <!-- رسائل الآخرين -->
    <div *ngIf="msg.sender.id !== studentId"
         class="p-2 rounded-lg bg-gray-200 text-black max-w-[70%] text-right shadow">
      <p class="font-semibold text-sm mb-1">الطالب: {{ msg.sender.name }}</p>
      <p class="text-sm break-words">{{ msg.message }}</p>
    </div>

  </div>

  <!-- زر عرض المزيد -->
  <div class="text-center mt-4" *ngIf="!allLoaded">
    <button
      class="bg-purple-600 hover:bg-purple-700 text-white py-1 px-4 rounded text-sm"
      (click)="loadMessages()"
      [disabled]="loading">
      {{ loading ? 'جاري التحميل...' : 'عرض المزيد' }}
    </button>
  </div>

</div>


  <!-- الإدخال -->
  <div class="flex gap-2 flex-col sm:flex-row">
    <input
      [(ngModel)]="newMessage"
      class="flex-1 border rounded p-2"
      type="text"
      placeholder="اكتب رسالتك هنا..."
    />
    <button (click)="sendMessage()" class="bg-blue-600 text-white px-4 py-2 rounded">
      إرسال
    </button>
  </div>
</div>
