<div class="p-6 bg-white shadow rounded" dir="rtl">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold text-[#2C2F66]">๐ ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช ุงูุฏุฑุงุณูุฉ</h2>
    <button class="bg-[#7F55E0] text-white px-4 py-2 rounded" (click)="openModal()">โ ูุฌููุนุฉ ุฌุฏูุฏุฉ</button>
  </div>

  <!-- ุงูุชุญููู -->
  <div *ngIf="loading" class="text-center py-10">
    <div class="w-10 h-10 border-4 border-purple-400 border-dashed rounded-full animate-spin mx-auto"></div>
    <p class="mt-2 text-sm text-gray-500">ุฌุงุฑู ุงูุชุญููู...</p>
  </div>

  <!-- ูุง ููุฌุฏ ูุฌููุนุงุช -->
  <div *ngIf="!loading && groups.length === 0" class="text-center text-gray-500">
    ูุง ุชูุฌุฏ ูุฌููุนุงุช ุญุงูููุง.
  </div>

  <!-- ุนุฑุถ ุงููุฌููุนุงุช -->
  <div *ngIf="!loading && groups.length > 0" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
    <div *ngFor="let g of groups" class="border p-4 rounded shadow bg-gray-50">
      <h3 class="text-lg font-semibold text-[#2C2F66]">{{ g.title }}</h3>
      <p class="text-sm text-gray-600 mb-2">{{ g.description }}</p>
      <p class="text-sm text-gray-500">๐ {{ g.start_time | date }} ุฅูู {{ g.end_time | date }}</p>

      <div class="mt-3 flex flex-wrap gap-2 text-sm">
        <button class="text-blue-600" (click)="viewSessions(g.id)">๐ ุงูุฌูุณุงุช</button>
        <button class="text-green-600" (click)="openSessionModal(g)">โ ุฌูุณุฉ ุฌุฏูุฏุฉ</button>
        <button class="text-orange-600" (click)="viewPending(g.id); selectedGroup = g">๐ ุงูุทูุจุงุช</button>
        <button class="text-[#7F55E0]" (click)="openModal(g)">โ๏ธ ุชุนุฏูู</button>
        <button class="text-red-600" (click)="deleteGroup(g.id)">๐ ุญุฐู</button>
      </div>
    </div>
  </div>

  <!-- ุงูููุฏุงู -->
  <div *ngIf="showGroupModal" class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50">
    <div class="bg-white rounded-lg shadow p-6 w-full max-w-md">
      <h3 class="text-lg font-semibold mb-4">{{ isEditMode ? 'ุชุนุฏูู ูุฌููุนุฉ' : 'ุฅูุดุงุก ูุฌููุนุฉ' }}</h3>
      <form [formGroup]="groupForm" (ngSubmit)="saveGroup()">
        <input type="text" formControlName="title" placeholder="ุนููุงู ุงููุฌููุนุฉ" class="w-full border rounded p-2 mb-3" />
        <textarea formControlName="description" rows="3" placeholder="ูุตู ุงููุฌููุนุฉ" class="w-full border rounded p-2 mb-3"></textarea>
        <input type="datetime-local" formControlName="start_time" class="w-full border rounded p-2 mb-3" />
        <input type="datetime-local" formControlName="end_time" class="w-full border rounded p-2 mb-3" />

        <div class="flex justify-end gap-2">
          <button type="button" class="bg-gray-400 text-white px-4 py-1 rounded" (click)="closeModal()">ุฅูุบุงุก</button>
          <button type="submit" [disabled]="groupForm.invalid" class="bg-[#7F55E0] text-white px-4 py-1 rounded">
            {{ isEditMode ? 'ุญูุธ ุงูุชุนุฏููุงุช' : 'ุฅูุดุงุก' }}
          </button>
        </div>
      </form>
    </div>
  </div>
<!-- Modal: ุฅูุดุงุก ุฌูุณุฉ -->
<div *ngIf="showSessionModal" class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50">
  <div class="bg-white p-6 rounded-lg w-full max-w-md">
    <h3 class="text-lg font-semibold mb-4">โ ุฅูุดุงุก ุฌูุณุฉ</h3>

    <form [formGroup]="sessionForm" (ngSubmit)="saveSession()">
      <!-- ุงูุนููุงู -->
      <input type="text" formControlName="title" placeholder="ุนููุงู ุงูุฌูุณุฉ"
             class="w-full border p-2 rounded mb-1" />
      <div *ngIf="sessionForm.get('title')?.invalid && sessionForm.get('title')?.touched" class="text-red-600 text-sm mb-2">
        ุงูุนููุงู ูุทููุจ
      </div>

      <!-- ุงููุตู -->
      <textarea formControlName="description" placeholder="ูุตู ุงูุฌูุณุฉ" rows="3"
                class="w-full border p-2 rounded mb-3"></textarea>

      <!-- ุงูููุช -->
      <input type="datetime-local" formControlName="session_time"
             class="w-full border p-2 rounded mb-1" />
      <div *ngIf="sessionForm.get('session_time')?.invalid && sessionForm.get('session_time')?.touched" class="text-red-600 text-sm mb-2">
        ููุช ุงูุฌูุณุฉ ูุทููุจ
      </div>

      <!-- ุงูุฑุงุจุท -->
      <input type="url" formControlName="link" placeholder="ุฑุงุจุท ุงูุฌูุณุฉ (Zoom, Meet...)"
             class="w-full border p-2 rounded mb-1" />
      <div *ngIf="sessionForm.get('link')?.invalid && sessionForm.get('link')?.touched" class="text-red-600 text-sm mb-2">
        ูุฑุฌู ุฅุฏุฎุงู ุฑุงุจุท ุตุญูุญ ูุจุฏุฃ ุจู http ุฃู https
      </div>

      <div class="flex justify-end gap-2 mt-2">
        <button type="button" class="bg-gray-400 text-white px-4 py-1 rounded" (click)="closeSessionModal()">ุฅูุบุงุก</button>
        <button type="submit" [disabled]="sessionForm.invalid" class="bg-[#7F55E0] text-white px-4 py-1 rounded">
          ุญูุธ
        </button>
      </div>
    </form>
  </div>
</div>


  <!-- ุงูุฌูุณุงุช -->
 <div  class="mt-6">
  <h4 class="text-lg font-semibold text-[#2C2F66]">๐ ุงูุฌูุณุงุช:</h4>
  <div *ngIf="sessions.length === 0" class="text-sm text-gray-500 mt-2">ูุง ุชูุฌุฏ ุฌูุณุงุช.</div>
  <ul *ngIf="sessions.length > 0" class="list-disc list-inside text-sm text-gray-700 mt-2">
    <li *ngFor="let s of sessions" class="flex justify-between items-center border-b py-2">
      <div>
        {{ s.title }} - {{ s.session_time | date:'medium' }}
        <a [href]="s.link" target="_blank" class="text-blue-600 underline ml-2">ุฑุงุจุท ุงูุฌูุณุฉ</a>
      </div>
      <button (click)="deleteSession(s.id)" class="text-red-600 hover:text-red-800 text-sm ml-2">๐๏ธ ุญุฐู</button>
    </li>
  </ul>
</div>


  <!-- ุงูุทูุจุงุช -->
  <div class="mt-6">
    <h4 class="text-lg font-semibold text-[#2C2F66]">๐ ุงูุทูุจุงุช ุงููุนููุฉ:</h4>
    <div *ngIf="pendingRequests.length === 0" class="text-sm text-gray-500">ูุง ุชูุฌุฏ ุทูุจุงุช.</div>
    <div *ngFor="let p of pendingRequests" class="flex justify-between items-center border-b py-2">
      <span>{{ p.student.user.name }}</span>
      <div class="flex gap-2 text-sm">
        <button class="text-green-600" (click)="approveRequest(p.id)">โ๏ธ ูุจูู</button>
        <button class="text-red-600" (click)="rejectRequest(p.id)">โ ุฑูุถ</button>
      </div>
    </div>
  </div>
</div>
